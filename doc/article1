BGP AS / ISP Security Ranking - Introduction and Datasets 

I am currently working on a project which aims to provide a whole architecture to parse dataset (logs, reports...), get the whois informations to know the owners of the IPs/Networks/ASNs and generate reports based on this informations.
It is open source and available there: http://gitorious.org/bgp-ranking

* Context 

For an Internet Service Provider, AS numbers are a logical representation of the other ISP peering or communicating with his autonomous system. ISP customers are using the capacity of the Internet Service Provider to reach Internet services over other AS. Some of those communications can be malicious (e.g. due to malware activities on an end-user equipments) and hosted at specific AS location. This project will provide an improved security view on those AS numbers, a trust ranking scheme will be implemented based on existing dataset of compromised systems, malware C&C IP and existing datasets of the ISPs.

If you are interested to use this application for your own purpose with your own datasets, you should read the following: I will give you the basics information on the existing modules to write a new.

* Existing modules 

** Dshield

http://www.dshield.org/xml.html

Dshiels provide two lists: 
- a list containing the 100 most reported IPs with sometime a reverse dns. We extract only the IPs because the reverse dns are too easy to falsify.
- the daily sources witch contains ~1.000.000 IPs, probably many false positives but it is at least usefull to stress-test the application :) 

** Zeustracker

http://www.abuse.ch/zeustracker/blocklist.php

Zeus provide a list to track the ZeuS Command&Control servers and malicious hosts which are hosting ZeuS files. It is just a list of ips. 

** Atlas

https://atlas.arbor.net/about/

Active Threat Level Analysis System is a list provided by Arbor which contains many informations on the tipe of the alert. The format of the report is a rss feed.
The reports are not freely available. 

** Shadowserver

http://www.shadowserver.org/wiki/

Shadowserver provide three lists containing about the same informations as atlas but are csv files. Of course, the three reports are slightly differents and needs three differents parsers... :) 
The reports are not freely available. 


* Write a new module

Each dataset needs a proper module to extract the needed informations. You can see the existings modules here: http://gitorious.org/bgp-ranking/bgp-ranking/trees/master/lib/modules
There is actually two families of modules :

** First family (Dshield and Zeustracker)

The freely available datasets contains the ip addresses and sometimes a reverse dns but this information is so easily falsified that it is totally unnecessary to save it. 
The dataset may contain the date of generation of the report, it will be extracted too. If there is no date in the file, the date will be set to 'today' (datetime.date.today()).

** Second family (Atlas and Shadowserver)

The reports provide more informations on the attackers. They provide obviously the ip but also the time of the attack, and the attack (the name of the malware, if known). 

Atlas provide some more informations such as an url to get more informations, the coverage time and category of the attack. But the atlas report is an xml file, this informations are extracted of the file and saved as a string in the database. 
Shadowserver is a csv report, the whole line will be pushed in the database. 

** Conclusion 

It is so really easy to write modules for other datasets: the only things to extract at least is the ip addresses and a date as to be given. To automatize the process, you have to give a unique name to your module and a directory where you will put the files to parse. 
If possible you should edit this file $ROOT/etc/init.d/start_fetch_raw_files.py and put an URL, your dataset will be automatically fetched and parsed. Else you will have to copy manually the dataset in the directory of your module. 

The rest will be done automatically, and 'the rest' will be explained in the next article. 
