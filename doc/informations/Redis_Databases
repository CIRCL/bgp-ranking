*** Database 0 ***

Contains only temporary information originating from the modules, and some helper keys.

# Helpers

uid: it is an integer, autoincremented 
When a module has a new entry to insert in the system, it increments this keys and use the integer as unique key. 

uid_list: it is a set of uid. It indexes all the new entries that the next process will insert in the system. 

Tips: 
To know the number of entries to insert in the system, do: 
	redis-cli -n 0 scard uid_list
If the key does not exists (the last command returns 0), there is no entries to insert. 

ris: a set of IPs. We want to know the RIS information for all the IPs in the set.
Note: the set may contains IPs that are already cached, it is not a problem: they will be automatically dropped by the fetching process. 

To know the number of RIS entries to fetch : redis-cli -n 0 ris

whois: same as ris but for the Whois information

# Temporaries information

All the information coming from the modules will have the following format: 
	<integer>|<string>
integer is an uid
string can be one of the following: 
	ip
	source
	timestamp
	infection
	raw
	times

If you see that there is a few keys in the database but uid_list does not exists, it is probably that you stop the processing of the new entries when it was running.
All the keys like <integer>|<string> can be dropped, they will never be inserted anymore. 


*** Databases 1 and 2 ***

This databases are completely volatile, db1 is a cache for the RIS Whois entries and db2 for Whois entries, they are cached 24 hours. 
The keys are IPs and the values are (RIS) Whois entries.

The two databases runs on a proper redis instance. 


*** Database 3 ***

This database is also temporary: it is used by the ranking process to dump the routing information provided by the RIPE. 

In a first time, the database contains only sets. The keys of the sets are ASN and they contains all the subnets announced by a particular AS. 

During the ranking, the total number of IPs announced by an AS is computed and also saved in the database. The keys have this format: 
	<asn>|rankv4
	<asn>|rankv6
and contains an integer.

The database is dropped when the ranking is computed.


*** Database 4 ***

Contains a sort of hash to find the right server to ask when you have an IP. It also contains information on arguments to pass when you do queries on some servers. 

You probably do not want to know anything more about it. (it needs some refactoring)

Last thing to know: if this database if not initialized, the system will not be able to do the RIS queries. 


*** Database 5 ***

From now, it will be fun. 

This database contains all the static information from the modules and the ASNs

# First state

As we already know, the information from the modules comes in a "raw" format in db1. 
At this point, we always know the IP, the source and a date. If the date is given in the dataset, this one is used, elsewhere, it will be 'today'.

## Sets: 
<day>|sources: contains all the sources for a particular day
temp|<day>|<source>|<ip_type>: temporary set of IPs for a day, by source. ip_type can be v4 of v6. The values are <ip>|<timestamp>, with the timestamp of the dataset or "today at midnight" if none has been found.

no_asn: a temporary set containing all the temp keys: temp|<day>|<source>|<ip_type>, until they are empty. 
Each IP is also inserted in the set ris of db1.

## Keys: 
A key is inserted only if there is more information (an infection, an number of times, a raw stuff) provided by the dataset.
A key looks like this: 
<ip>|<timestamp>|{infection,times,raw} 
And the value is the one given by the module. 





*** Database 6 ***
